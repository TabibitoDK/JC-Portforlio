title: カンバスペンターの機能更新
desc:
  created: 2022-6-24 12:58
  edited: 2022-6-30 21:50
  by: JC
body:
  - > 
      この2週間、ペインターアプリのボタン機能の実装に集中していました。ユーザーがストロークや色のデータを保存して、アプリにロードできる機能が欲しい。
      アプリに戻せるようにしたい。また、キャンバス全体を簡単にクリアできるキャンバスクリアボタンや、アンドゥ、リドゥ機能も追加したい。アンドゥ、リドゥ、クリアボタンはうまく実装されています。
      うまく実装できましたが、データを保存する方法についていろいろ考えました。
  - >
      最初は単純にjsonで保存していたのですが、後になってこの方法はつまらないし、特別な方法でもないと思いました。そこで、データを画像に埋め込んで保存することにした。
      画像と一緒にデータをダウンロードし、その画像をアプリに再度読み込ませることで、図面を追加したり編集したりすることができます。いろいろ調べた結果、文字列をバイト配列として保存し、それを 
      バイト配列の末尾に追加するのが、画像データの保存を実現する最も簡単な方法であることがわかった。そこで、この方法で画像の保存機能を実装した。
  - > 
      数日後、画像の保存と読み込み機能をテストしていたところ、データ付きで保存された画像に問題があることに気づきました。その結果、一部の画像を開くプログラムでは、画像データの末尾にデータが付加されているため、データ付き画像を認識できません。
      画像データの末尾にデータが付加されているため、データ付き画像を認識しないのです。そこで、画像にデータを保存する他の方法をインターネットで探し始めました。検索した結果 <br>
      <a href="https://www.youtube.com/watch?v=TWEXCYQKyDc">Secrets Hidden in Images (Steganography) - Computerphile</a> <br>
      による画像ステガノグラフィーのユーチューブ・ビデオを見た。
      その方法は、画像の色を表すバイトの最下位2ビットにデータを置くというものだ。そこで、この方法で保存機能をアップデートした。ただし、旧方式の画像も 
      画像データの末尾に'DATA'という行を追加する）。
  - >

img: 
  - ../images/canvas painter Update01_ 01.png
  - ../images/canvas painter Update01_ 02.png
  - ../images/canvas painter Update01_ 03.png
  - ../images/canvas painter Update01_ 04.png